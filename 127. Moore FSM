/*
Developer   - Sriram Venkata Krishna
Date        - 27-10-2025
Platform    - HDL Bits
*/

//127. Moore FSM

module top_module 
    (
        input clk,
        input reset,
        input [3:1] s,
        output fr3, fr2,
        output fr1, dfr
	); 
    
    parameter S0 = 0, S1 = 1, S2 = 2, S3 = 3;
    reg [1:0] prev_state, state;
    
    always @(*) begin
        case(state) 
            S0 : {fr1, fr2, fr3} = 3'b111;
            S1 : {fr1, fr2, fr3} = 3'b110;
            S2 : {fr1, fr2, fr3} = 3'b100;
            S3 : {fr1, fr2, fr3} = 3'b000;
        endcase
    end
    
    always @(posedge clk) begin
        prev_state = state;
        
        if(reset) begin
            state = S0;
            dfr = 1;
        end
        
        else if(s[3]) begin
            state = S3;
            dfr = 0;
        end
        
        else if(s[2]) begin
            state = S2;
            
            if(prev_state > state) begin
                dfr = 1;
            end
            
            else if(prev_state < state) begin
                dfr = 0;
            end
        end
        
        else if(s[1]) begin
            state = S1;
            
            if(prev_state > state) begin
                dfr = 1;
            end
            
            else if(prev_state < state) begin
                dfr = 0;
            end
        end
        
        else begin
            state = S0;
            dfr = 1;
        end
    end

endmodule
